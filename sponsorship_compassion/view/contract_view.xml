<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>
		<record id="view_sponsorship_contract_form_compassion" model="ir.ui.view">
			<field name="name">sponsorship.contract.compassion.form</field>
			<field name="model">recurring.contract</field>
            <field name="inherit_id" ref="recurring_contract.view_recurring_contract_form"/>
			<field name="arch" type="xml">
                <button name="contract_terminated" position="attributes">
                    <attribute name="attrs">{'invisible':[('type', '=', 'S')]}</attribute>
                </button>
                <button name="contract_terminated" position="after">
                     <button name="%(action_end_sponsorship)d" type="action" string="Terminate" class="oe_highlight" attrs="{'invisible': ['|',('type', '!=', 'S'),('state', 'not in', ['waiting', 'mandate', 'active'])]}"/>
                </button>          
            </field>
		</record>

        <record id="action_sponsorship_contract" model="ir.actions.act_window">
            <field name="name">Sponsorships</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">recurring.contract</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('type','=','S')]</field>
            <field name="context">{'default_type':'S'}</field>
        </record>
        
        <!-- Move the Sponsorships Menu to the Sponsorship Section -->
        <menuitem id="menu_sponsorship_contract_form" parent="child_compassion.menu_sponsorship_section"
                  name="Sponsorships" sequence="0" action="action_sponsorship_contract"/>
        <menuitem id="contract_compassion.menu_contracts_section" parent="child_compassion.menu_sponsorship_root" 
                  name="Invoicing" groups="account.group_account_user" sequence="2"/>
        <menuitem id="open_customers" parent="child_compassion.menu_sponsorship_section"
                  name="Partners" action="base.action_partner_customer_form" sequence="3"/>
	</data>
</openerp>
